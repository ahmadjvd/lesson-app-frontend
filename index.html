<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson App</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"></script>
  <link rel="stylesheet" href="style.css">

</head>
<body>
    <div id="app">
    <!-- Title and Cart Button -->
    <div class="header">
      <h1>After School Activities</h1>
      <button @click="togglePage" :disabled="cart.length === 0" class="cart-button">
        Go to Cart ({{ cart.length }} items)
      </button>
    </div>

    <!-- Main Content Area -->
    <div class="content">
      
      <!-- Search and Sort Controls -->
      <div class="controls-container" v-if="currentPage === 'lesson'">
        <div class="control-item">
          <input 
            type="text" 
            id="search" 
            v-model="searchQuery" 
            placeholder="Search for lessons..." 
            @input="searchLessons"
          />
        </div>

        <div class="control-item">
          <select v-model="sortAttribute" @change="sortLessons">
            <option value="subject">Sort by Subject</option>
            <option value="location">Sort by Location</option>
            <option value="price">Sort by Price</option>
            <option value="Spaces">Sort by Spaces</option>
          </select>
        </div>
        
        <div class="control-item">
          <select v-model="sortOrder" @change="sortLessons">
            <option value="asc">Ascending</option>
            <option value="desc">Descending</option>
          </select>
        </div>
      </div>

      <!-- Product Grid -->
      <div v-if="currentPage === 'lesson'" class="product-container">
        <div v-for="lesson in sortedLessons" :key="lesson.id" class="lesson">
          <i :class="getIconForSubject(lesson.subject)" class="lesson-icon"></i>
          <img :src="`https://lesson-app-backend-5pwp.onrender.com/images/${lesson.image}`" alt="">
          <h2>{{ lesson.subject }}</h2>
          <p>Location: {{ lesson.location }}</p>
          <p>Price: ${{ lesson.price }}</p>
          <p>Spaces available: {{ lesson.Spaces }}</p>

          <button :disabled="lesson.Spaces <= 0" @click="addToCart(lesson)">
            Add to Cart
          </button>
        </div>
      </div>

      <!-- Cart Page -->
      <div v-if="currentPage === 'cart'" class="cart-section active">
        <h3>Your Shopping Cart</h3>
        <ul>
          <li v-for="(cartItem, index) in cart" :key="cartItem.id">
            <img :src="`https://lesson-app-backend-5pwp.onrender.com/images/${cartItem.image}`" alt="lesson" class="cart-item-image">
            <div class="cart-item-details">
                <h4>{{ cartItem.subject }}</h4>
                <p>Location: {{ cartItem.location }}</p>
                <p>Price: ${{ cartItem.price }} (x{{ cartItem.quantity }})</p>
            </div>
            <button @click="removeFromCart(cartItem)">
                Remove
            </button>
        </li>
        </ul>
        <p>Total: ${{ totalPrice }}</p>

        <div>
          <label for="name">Name:</label>
          <input 
            type="text" 
            id="name" 
            v-model="name" 
            placeholder="Enter your name" 
            @input="validateInput"
          />

          <label for="phone">Phone:</label>
          <div class="phone-input">
            <select v-model="phonePrefix" @change="validateInput">
              <option value="050">050</option>
              <option value="052">052</option>
              <option value="055">055</option>
              <option value="056">056</option>
              <option value="059">059</option>
            </select>

            <input 
              type="text" 
              id="phone"
              v-model="phoneDigits"
              placeholder="Enter 7 digits"
              maxlength="7"
              @input="validateInput"
            />
          </div>

          <p v-if="phoneError" class="error">
            {{ phoneError }}
          </p>
        </div>

        <button 
          :disabled="!isFormValid" 
          @click="checkout"
          class="checkout-button"
        >
          Checkout
        </button>
        
        <p v-if="orderConfirmed" class="success">Your order has been successfully submitted!</p>
        
        <button @click="togglePage">Back to Lessons</button>
      </div>
    </div>
  </div>
  <script src="index.js"></script>
</body>
</html>